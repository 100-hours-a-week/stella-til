## 날짜: 2024-12-18

### 스크럼
- 학습 목표 1 : TCP 세그먼트
- 학습 목표 2 : HTTP 보안 헤더

### 새로 배운 내용
#### 주제 1: TCP 세그먼트
- TCP 헤더에 담긴 필드
    - Source/Destination Port Number
    IP헤더에 담긴 IP주소를 기반으로 양쪽 호스트 내 Endpoint가 되는 종단 프로세스를 식별하기 위한 필드

    - Sequence Number
    바이트 단위로 구분되어 순서화되는 번호

    - Acknowledgement Number
    확인 응답 번호로, 수신하기를 기대하는 다음 바이트 번호를 전송

    - Data Offset (=HLEN)
    전체 세그먼트 중에서 헤더가 아닌 실제 데이터의 시작 위치를 표시

    - Flag
    1비트씩 할당된 9개의 비트 플래그

    - Window Size
    한번에 전송할 수 있는 데이터의 양을 의미하는 값을 담음

    - Check Sum
    데이터 송신 중에 발생할 수 있는 오류를 검출하기 위한 값

    - Urgent Pointer
    긴급 포인터
    URG 플래그가 1이라면, 수신 측은 이 포인터가 가리키고 있는 데이터를 우선적으로 처리

#### 주제 2: HTTP 보안 헤더
- 공격자들이 악용할 수 있는 보안 취약점이 여러 개 존재
-  OWASP 권장 사항 기반 보안 헤더 적용

`CSP(Content-Security-Policy) 헤더`
CSP는 웹 어플리케이션에 대한 XSS 공격을 방지하기 위한 역할

`HSTS(HTTP Strict-Transport-Security)`
HSTS는 웹 애플리케이션과 사용자 간의 모든 통신이 HTTPS 프로토콜을 통해 이루어지도록 강제

`X-Content-Type-Options`
브라우저가 MIME 타입 스니핑을 방지하여, 공격자가 MIME 타입을 활용하여 공격하는 것을 막음.

`X-Frame-Options`
X-Frame-Options 헤더는 클릭재킹 공격에 대응하여 웹 페이지가 다른 페이지의 프레임 내에 표시되는 것을 방지

## 오늘의 도전 과제와 해결 방법
### 도전 과제 1: EC2 동일 서버에 프론트엔드, 서버 동시 배포
- 발생 문제 : 프론트엔드는 localhost에서 실행, 서버만 EC2 서버에 먼저 띄워 연결 확인 후 프론트엔드 띄울 예정이었으나 쿠키/세션의 설정으로 불가능해짐

- 문제 원인 : 현재 서버는 로그인, 회원가입을 제외한 모든 API는 authorization이 수행되는 미들웨어를 거쳐서 통과됨. 그러나 쿠키는 동일하지 않은 도메인을 가진 경우, 서버로 전송되지 않음. 
- 처음에는 `sameSite : none`옵션을 세션 옵션에 추가하였으나 이는 https일 경우에만 허용된다고 하여 근본적인 해결책은 되지 못했음
- 따라서 프론트엔드를 동일한 서버에 올리는 방식을 택했고, 두 서버가 동일한 인스턴스에 존재하나 다른 포트를 가질 수 있도록 세팅함

### 도전 과제 2: 데이터베이스 식별관계 설정시 부모키를 활용한 복합키가 꼭 필요한가에 대한 고찰
1. 식별 관계에서 PK로 무조건 자식 관계의 아이디와 부모의 아이디 두개를 삼아야하는 것은 아니다.
- 상황에 따라 달라진다.
    - 자식 테이블이 독립적인 유니크 키를 가지는 경우에는 부모 아이디를 키로 삼지 않아도 된다.
        - ex) 게시글과 댓글의 관계
        - 댓글은 comment ID를 유니크키로 가지고 있고, 게시글과 의존 관계지만 게시글의 키를 부모키로 삼지 않아도 된다.
            - 이유는 게시글이 있어야 댓글이 존재할 수 있는 것은 맞지만, commentID만으로 댓글의 고유성은 구분할 수 있기 때문
    - 부모 테이블이 자식 테이블의 식별을 도와줘야 하는 경우에는 키로 삼는다.
        - ex) 게시글과 좋아요의 관계
        - 사용자 1명당 게시판 하나에 1개의 좋아요만 가질 수 있는 제약 조건이 있기 때문에, 이러한 제약조건을 세팅해주기 위해서는 게시글과 사용자를 동시에 키로 삼는 작업이 필요하다.
            
            ⇒ 그러나 이것 또한 무조건적인 방법은 아님
            독립적인 PK를 추가하고, 게시글 하나와 유저 아이디 조합에 대한 유니크 인덱스를 생성하는 방법이 존재한다.
            
2. 데이터베이스의 설계는 비즈니스 로직 강제성, 혹은 개발 편의성 등 다양한 방면을 고려할 수 있다. 본인만의일관성과 규칙을 가지고 설계해나가는 것이 중요할 것으로 보인다.


### 오늘의 회고
- 머리에 너무 많은 내용을 집어넣으려고 하니 과부하가 온 것 같다. 특히 네트워크 분야는 여전히 너무 어렵다. TCP 통신 방식에 대해서 더 깊이 공부가 필요할 것 같다.

### 참고 자료 및 링크
https://inpa.tistory.com/entry/NODE-%EB%B3%B4%EC%95%88-%F0%9F%93%9A-helmet-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%9B%B9-%EB%B3%B4%EC%95%88%EC%9D%80-%EB%82%B4%EA%B0%80-%F0%9F%91%AE
https://blog.naver.com/sparrowast/223365006198
https://zulloper.github.io/posts/HTTP-Security-Headers/
https://velog.io/@aerirang647/MIME-type%EC%9D%B4%EB%9E%80
https://webhack.dynu.net/?idx=20161120.001